(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{4088:function(e,t,o){Promise.resolve().then(o.bind(o,912)),Promise.resolve().then(o.bind(o,1481)),Promise.resolve().then(o.bind(o,6023))},912:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let r=o(5592);function n(e){let{reason:t,children:o}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return o}},1481:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return a}});let r=o(7437),n=o(8512);function a(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let o=(0,n.getExpectedRequestStore)("next/dynamic css"),a=[];if(o.reactLoadableManifest&&t){let e=o.reactLoadableManifest;for(let o of t){if(!e[o])continue;let t=e[o].files.filter(e=>e.endsWith(".css"));a.push(...t)}}return 0===a.length?null:(0,r.jsx)(r.Fragment,{children:a.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:o.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},6023:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return g}});var r=o(7437),n=o(2265),a=o(6665),s=o(8767),i=o.n(s),l=o(6648),u=()=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(l.default,{src:a.default,className:i().iconoImage,alt:"Logo"})}),c=o(1270),d=o(5634),f=o(6463),h=o(4379),p=o.n(h),g=()=>{let{login:e}=(0,c.useAuth)(),t=(0,f.useSearchParams)(),o=(0,f.useRouter)(),a=t.get("verify"),s=t.get("token"),i=t.get("issuedAt"),l=t.get("expiresAt"),h=t.get("agente"),g=t.get("userId"),m=t.get("userEmail"),y=t.get("userNombre"),w=t.get("userRole");return(0,n.useEffect)(()=>{(async()=>{if("true"===a){if(s&&i&&l&&g&&m&&y&&w&&h)try{let t=await (0,d.pH)(g,s);t&&(e({tokenData:{succes:"ok",token:s,issuedAt:i,expiresAt:l,agente:h,user:{id:g,email:m,nombre:y,roles:[w]},keyProperty:null},userData:t}),p().fire({title:"\xa1Acceso exitoso!",html:'<h1 style="color:gray; font-size:25px; font-weight: 500;">Bienvenido(a):</h1>\n                                   <p style="margin-top:10px">'.concat(t.email,'</p> \n                                   <p style="font-size:20px">').concat(t.nombre,"</p>"),icon:"success",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"Ok"}))}catch(t){let e=t.message;p().fire({icon:"error",title:"Oops...",text:e,showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"Ok"})}}else o.push("/"),p().fire({icon:"error",title:"Oops...",text:"Usuario no reconocido en el sistema, porfavor pongase en contacto con el administrador",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"Ok"})})()},[h,l,i,e,o,s,m,g,y,w,a]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{}),(0,r.jsx)("h1",{className:"text-gray-500 font-medium text-2xl text-center mt-[30%]",children:"Verificando credenciales..."})]})}},1270:function(e,t,o){"use strict";o.d(t,{AuthProvider:function(){return u},useAuth:function(){return c}});var r=o(7437),n=o(2265),a=o(6463),s=o(277),i=o(5634);let l=(0,n.createContext)({userData:null,setUserData:()=>{},login:()=>{},logout:()=>{},renewToken:()=>{}}),u=e=>{let{children:t}=e,[o,u]=(0,n.useState)(null),c=(0,a.useRouter)();(0,n.useEffect)(()=>{o&&o.tokenData&&((0,s.setCookie)(null,"authToken",o.tokenData.token,{maxAge:2592e3,path:"/"}),localStorage.setItem("userSession",JSON.stringify(o)))},[o]),(0,n.useEffect)(()=>{if(window.localStorage){let e=localStorage.getItem("userSession");e&&u(JSON.parse(e))}let e=e=>{"userSession"===e.key&&(e.newValue?(u(JSON.parse(e.newValue)),c.push("/")):(u(null),localStorage.removeItem("userSession"),(0,s.destroyCookie)(null,"authToken"),window.location.reload()))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[c]);let[d,f]=(0,n.useState)(!1);(0,n.useEffect)(()=>{d&&c.push("/dashboard/home")},[d]);let h=()=>{u(null),localStorage.removeItem("userSession"),localStorage.removeItem("selectedCampus"),(0,s.destroyCookie)(null,"authToken"),f(!1),c.push("/")},p=async()=>{if(o&&null!==o.tokenData.keyProperty)try{let e={email:o.userData.email,password:o.tokenData.keyProperty},t={tokenData:{...await (0,i.l)(e),keyProperty:e.password},userData:o.userData};u(t),window.location.reload()}catch(e){console.error("Error renovando el token:",e),h()}};return(0,r.jsx)(l.Provider,{value:{userData:o,setUserData:u,login:e=>{u(e),f(!0)},logout:h,renewToken:p},children:t})},c=()=>(0,n.useContext)(l)},5634:function(e,t,o){"use strict";o.d(t,{GA:function(){return l},JS:function(){return u},QH:function(){return n},l:function(){return s},pH:function(){return i},zm:function(){return a},zr:function(){return c}});var r=o(8472);let n="http://localhost:3000",a="/users/auth0/callback";async function s(e){try{console.log("formData",JSON.stringify(e));let t=await fetch("".concat(n,"/auths/signin"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}),o=await t.json();if(200===t.status)return o;throw Error(null==o?void 0:o.message)}catch(e){throw Error(e)}}async function i(e,t){try{let o=await fetch("".concat(n,"/users/").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}),r=await o.json();if(200===o.status)return r;throw Error(null==r?void 0:r.message)}catch(e){throw Error(e)}}let l=async(e,t)=>{try{return(await r.Z.get("http://localhost:3000/users/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})).data}catch(e){if(r.Z.isAxiosError(e)){var o,n;throw console.error("Error en la solicitud Axios:",e.message),Error((null===(n=e.response)||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:o.message)||"Error al obtener los datos del usuario")}throw console.error("Error desconocido:",e),Error("Error desconocido al obtener los datos del usuario")}},u=async(e,t)=>{try{return(await r.Z.delete("http://localhost:3000/users/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})).data}catch(e){if(r.Z.isAxiosError(e)){var o,n;throw console.error("Error en la solicitud Axios:",e.message),Error((null===(n=e.response)||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:o.message)||"Error al eliminar el usuario")}throw console.error("Error desconocido:",e),Error("Error desconocido al eliminar el usuario")}},c=async(e,t)=>{try{return(await r.Z.post("http://localhost:3000/auths/signup",e,{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}})).data}catch(e){if(r.Z.isAxiosError(e)){var o;console.error("Error en la creaci\xf3n del usuario:",(null===(o=e.response)||void 0===o?void 0:o.data)||e.message)}else console.error("Error inesperado:",e);throw e}}},8767:function(e){e.exports={iconoImage:"Loading_iconoImage__RtjfI","iconoImage-spin":"Loading_iconoImage-spin__Q_Y42"}},6665:function(e,t,o){"use strict";o.r(t),t.default={src:"/_next/static/media/Logo01.530fe2b7.png",height:853,width:1050,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAYAAAD+Bd/7AAAAvklEQVR42mM4ffoEIwMQPHlw1/38hQtdW3btmTJz1UYpkNjmXfuZGUBgy/YdcZMXr7wydeWGxoWbdhyfv3bTsdv3H6kwwMCylatPTFi47HH9rNU7epdsuTZp8er/W3ftnc4AAy09U5auWLXye/3MZcv6lm+93Tpv+e3t+w43MCABsa7Js3at3rCxZfu+/d2HTp2t+vX/PycDCGzYtMn70OFDNus3brJes3Zd3u5dO/P37NoeuXXr5vwzZ067AABVeGDvqgIvGgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:6}}},function(e){e.O(0,[411,461,178,648,971,23,744],function(){return e(e.s=4088)}),_N_E=e.O()}]);